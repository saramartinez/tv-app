{% extends 'base.html' %}
{% block body %}

{% if favorites %}
<div class="row">
	{% for favorite in favorites %}
		{% if favorite.show.img %}
		<div class="col-md-3">
			<p><img class="img-thumbnail" src="{{ favorite.show.img }}" alt="{{ favorite.show.title }}"></p>
		</div>
		<div class="col-md-9">
		{% else %}
		<div class="col-md-12">
		{% endif %}
<div class="panel panel-default">
<div class="panel-heading lead">Listings for <strong>{{ favorite.show.title }}</strong>
</div>
		{% if schedule[loop.index-1] %}
	<table class="table table-striped table-responsive">
	<thead> 
	<tr>
		<th class="table-header-date">Date</th>
		<th class="table-header-time">Time</th>
		<th class="table-header-channel">Channel</th>
		<th class="table-header-synopsis">Synopsis</th>
		<th></th>
	</tr>
	</thead>

	<tbody>
{% for item in schedule[loop.index-1] %}
<script>
	$(document).ready(function() {
	$(".schedule").each( function() {
	var air_time = moment.utc("{{ item['AiringTime'] }}").local();
	var air_date = air_time
	air_time = air_time.format("LT");
	air_date = air_date.format("dddd, MMMM Do");

	var from_now = moment("{{ item['AiringTime'] }}").fromNow();
	
	$(".{{ item['ProgramId'] }}-date").html(air_date);
	$(".{{ item['ProgramId'] }}-time").html(air_time + " <em>(" + from_now + ")</em>") });
			});
</script>

	<tr class="schedule">

	<td class="{{ item['ProgramId'] }}-date"></td>
	<td class="{{ item['ProgramId'] }}-time"></td>
	<td>{{ item['Channel'] }} {% if item['HD'] %}<strong>(HD)</strong>{% endif %} <em>({{ item['SourceLongName'] }})</em>
	</td>
	
	<td>
	{% if item['EpisodeTitle'] %}
		<em>"{{ item['EpisodeTitle'] }}" â€”</em>
	{% endif %}

	{% if item['Copy'] %}
		{{ item['Copy'] }}
	{% endif %}
	</td>
	{% if item['AiringType']=='New' %}
		<td><strong>New Episode</strong></td>
	{% else %}
		<td><em>Repeat</em></td>
	{% endif %}
	</tr>
{% endfor %}
	</tbody>
</table>
</div>
		{% else %}
			<ul><li>
				No showtimes in the next week.
			</li></ul>
		{% endif %}

		</div></div>

	{% endfor %}



{% else %}
It looks like you don't have any favorites saved. Search for a show and add it to your favorites to see upcoming TV listings.
{% endif %}


{% endblock %}