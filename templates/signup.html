{% extends 'base.html' %}
{% block body %}
<script>
$SCRIPT_ROOT = {{ request.script_root|tojson|safe }};


$(document).ready(function() {

	$("#get-service").click( 
		// function to check length of keypress then once it's greater than 5, call this function	
		function(e) {
		var url = "/find-provider?zipcode=" + $("#zipcode-field").val();
		$.get(url,
			function(result) {
				console.log(result.services)
				$(result.services).each( function() {
					$("#service-options").append("<li><label><input type='radio' name='service-provider' value='" + this['ServiceId'] + "'>" + this['Name'] + "</label></li>"
						);
				});
		});
	});
});

</script>



<h2>New users, sign up:</h2>

<form id="signup" action="/signup" method="POST">
    <label><input type="username" name="username" placeholder="Name" required autofocus /></label><br>
    <label><input type="email" name="email" placeholder="Email Address" required /></label><br>
    <label><input type="password" name="password" placeholder="Password" required /></label><br>
    <label><input type="zipcode" id="zipcode-field" name="zipcode" placeholder="Zip Code" required /></label><br><button id="get-service" type="button">Find service provider</button>
    <ul id="service-options">
    </ul>
<span id="timezone-input"></span>
<script src="//cdnjs.cloudflare.com/ajax/libs/jstimezonedetect/1.0.4/jstz.min.js"></script>
<script>
var localTime = jstz.determine();
var timezone = localTime.name();

var tz = document.createElement("INPUT");
tz.setAttribute('type', 'hidden');
tz.setAttribute('name', 'timezone');
tz.setAttribute('value', timezone);

$("#timezone-input").append(tz);
</script>



<br><br><br>



    <label><input type="submit" value="Sign Up"></label>
</form>
{% endblock %}